## command for intereactive session

srun -p nvidia -N 1 -c 1 --gres=gpu:a100:1  --time=7:59:59 --mem=100GB -q ebrainccs /bin/bash

srun -p compute -N 1 -c 1 --time=7:59:59 --mem=50GB /bin/bash

srun --pty -p nvidia -C 80g --nodes=1 --ntasks-per-node=1 --cpus-per-task=3 --gres=gpu:a100:3 --time=47:59:59 --mem=100GB -q ebrainccs --job-name=train /bin/bash

##command for installing cudatoolkit:
conda install conda-forge::cudatoolkit==11.7.0

## command for installing cudatoolkit-dev
conda install conda-forge::cudatoolkit-dev


##for exporting path:
!export LD_LIBRARY_PATH=/home/ltl2113/miniconda3/envs/llavamed/lib:$LD_LIBRARY_PATH


#removing files 
rm -r Path/to/folderOrFile

#listing the number of files in the current directory
ls | wc -l

#checking the memory of all files in current directory 
du -h --max-depth=1


#################INFERENCE RESULTS####################
##Example 0:
{
    "question_id": 1,
    "prompt": "What is the organ in the image?\n<image>",
    "text": "Preoperative plain radiograph of the spine.",
    "answer_id": "NC6CNjV7BkshapHedqPjzo",
    "model_id": "/scratch/ltl2113/LLaVA-Med/checkpoints/llava-med-7b-pretrain-02",
    "metadata": {}
}


#Example 1
## Ground truth:

        "id": "35189814_Fig2",
        "image": "35189814_Fig2.jpg",
        "conversatons": [
            {
                "from": "human",
                "value": "Provide a detailed description of the given image\n<image>"
            },
            {
                "from": "gpt",
                "value": "Histology of resected aneurysmal tissue. Hematoxylin and eosin stain of the excised aneurysmal tissue revealed bacterial colonies in the vascular wall tissue at (40\u00d7 magnification) (A). The bacterial colonies are better seen at a higher power (400\u00d7 magnification) (B). Gram stain of the tissue shows gram-negative bacteria (C)"
            }
        ]
    }

        ]
## LLAVAMED model output 
{
    "question_id": 1,
    "prompt": "Provide a detailed description of the given image\n<image>",
    "text": "H&E staining of the liver biopsy specimen shows hepatocyte ballooning, Mallory bodies and diffuse pericellular fibrosis.",
    "answer_id": "9ehvuFvXdFiUQEarpBCP5u",
    "model_id": "/scratch/ltl2113/LLaVA-Med/checkpoints/llava-med-7b-pretrain-02",
    "metadata": {}
}




# Example 2:
## Ground truth
     {
        "id": "31178693_F4",
        "image": "31178693_F4.jpg",
        "conversatons": [
            {
                "from": "human",
                "value": "Portray the image with a rich, descriptive narrative\n<image>"
            },
            {
                "from": "gpt",
                "value": "Immunohistochemical characterization of c-Fos positive cells in ovBNST in THIP-treated mice. Immunohistochemical staining for corticotropin-releasing factor (CRF, green) in BNST sections of Somatostatin-tdTomato (red) mice revealed that 64% c-Fos-expressing cells in the ovBNST, activated by THIP treatment, also express CRF. (A) Triple fluorescence labeling of CRF (green), Somatostatin (red, Sst) and c-Fos protein (black nuclei) in the ovBNST at high magnification. Scale bar: 100 \u03bcm. aca, anterior commissure; ic, internal capsule. (B) In line with the previous experiment (Figure 3), THIP induced a robust c-Fos activation in the ovBNST. The total number of c-Fos+ cells in the ovBNST are given as individual data points with means \u00b1 SEM, n = 5 and 4 mice treated with saline vehicle (Veh) and THIP, respectively; **p = 0.01 (t-test). (C) A pie chart representing the fractions of CRF/c-Fos+ (green), Sst/c-Fos+ (red), CRF/Sst/c-Fos+ (orange) and non-identified c-Fos+ (gray) cells in THIP-treated mice (n = 4)."
            }


## LLAVAMED Model output
{
    "question_id": 1,
    "prompt": "Portray the image with a rich, descriptive narrative\n<image>",
    "text": "Examples of CREB immunoreactivity in the hippocampal CA1 region (A) and the dentate gyrus (B,C) of a representative rat in the sham group and a representative rat in the OL group. (A) CREB immunoreactivity in the hippocampal CA1 region. (B,C) CREB immunoreactivity in the dentate gyrus. Arrowheads indicate the DG (B) and the CA3 region (C). Bars = 100 \u03bcm. (D) Quantification of CREB immunoreactivity in the hippocampal CA1 and the dentate gyrus (DG) of the OL and sham groups. Data are expressed as the mean \u00b1 SEM of the three independent experiments. *p < 0.05 and **p < 0.01.",
    "answer_id": "JsyLBqUbtCwZDn4ZBKzNUK",
    "model_id": "/scratch/ltl2113/LLaVA-Med/checkpoints/llava-med-7b-pretrain-02",
    "metadata": {}
}

    